<h1>ジョブ管理</h1>
利用者からみて一連のまとまった指示について、一つの単位としてジョブとしてまとめてカーネルが制御する。<br>
複数の命令をまとめたバッチファイル1つを一つのジョブと見なして効率よく実行するのと似ている。<br>
<h2>ジョブ管理の流れ</h2>
マスタスケジューラという管理プログラムがあるので、利用者はマスタスケジューラに対してジョブの実行を依頼。<br>
↓<br>
依頼を受け取ったマスタスケジューラが、ジョブスケジューラに依頼。自分は実行状況を監視して必要があれば利用者にフィードバック。<br>
↓<br>
ジョブスケジューラ<br>
リーダ(ジョブ待ち行列に登録)<br>
イニシエータ(優先度の高いジョブをジョブステップごとに細分化し、タスク管理に対して依頼)<br>
タスク管理にてジョブステップ実行<br>
ターミネータ(実行が終わったジョブを、出力待ちとして登録。実行のために使っていた記憶装置などのハードウェア資源を開放。)<br>
ターミネータ(実行が終わったジョブを、出力待ちとして登録。実行のために使っていた記憶装置などのハードウェア資源を開放。)<br>
ライタ(優先度の高いジョブから順に結果を出力)<br>
<h1>スプーリング</h1>
CPU(高速)と入出力装置(低速)との処理速度の差異を解決して効率を上げる手段。<br>
具体的には<br>
低速な装置とやり取りする際、高速な磁気ディスクを介して行い、処理効率を高める。<br>
上の行列ジョブスケジューラの待ち行列の行列を作る場所に当たる。処理はできなくてもスプール(貯めて)おくのは高速なので処理が止まらない。<br>
これにより、CPU側は入出力を待たずに磁気ディスクに処理結果を積み上げていけばいいので効率が上がる。<br>
併せて、入出力装置も1回ずつ処理結果が渡されるのを待たずにスプールされたデータをどんどん処理すればいいので早い。<br>
この時の装置ごとの単位時間あたりに処理できる仕事量をスループットと呼ぶ。<br>
<h1>タスク管理</h1>
ジョブがジョブステップに分解されタスク管理に渡されると、タスクが生成される。<br>
タスク=CPUでの仕事の単位。<br>
タスクの状態は３パターンあり、CPUの使用権待ちの順番や優先度などに応じて状態遷移する。<br>
①実行可能状態(実行待ち)<br>
②実行状態(CPU使用して実行中)<br>
③待機状態(実行中に発生した入出力処理が発生したため、処理終了を待機中)<br>
【重要】待機状態→実行状態に切り替わることはできず、必ず実行可能状態を挟む必要がある。<br>
また、状況によっては実行状態中にほかのタスクにCPUを明け渡すために終わってなくとも実行状態→実行可能状態になることもある。<br>
実効可能状態⇔実行状態の采配をするのがディスパッチャ<br>
ディスパッチャのタスクの割り振りの方式のことをタスクスケジューリングという。<br>
<h1>タスクスケジューリングの種類</h1>
<h2>到着順方式</h2>
実効可能状態になった順。タスクの内容によっての優先順位の概念がなく、実行途中でCPU使用権が奪われることがない。(ノンプリエンプション)<br>
<h2>優先順(プライオリティ)</h2>
タスクに優先度を設定し、優先度順に実行していく。<br>
実行中のタスクより高い優先度のものが後から実行可能状態に登場すると、実行途中でCPU使用権は後から来た優先度の高いものに移る。(プリエんぷしょん)<br>
<h2>ラウンドロビン方式</h2>
CPU使用権を一定時間ごとに切り替える。<br>
一定時間を超えると、タスク実行中でも使用権が移る。実行中タスクは実行待ちの最後に回る。<br>
<h1>マルチプログラミング</h1>
CPUの有効活用、遊んでいる時間がないように複数のタスクを並行して実行し、CPUのアイドル時間(遊休時間)をなくす。<br>
タスクAの実行中に入出力処理に入った裏で、タスクBのCPU処理を割り込ませる。といった動き<br>
<h1>割込み処理</h1>
実行中タスクの途中に他のタスクの処理が割り込み、実行中タスクを待機状態もしくは実行可能状態に切り替える処理。<br>
タスクスケジューリングのルール(持ち時間や優先度)と、マルチプログラミング(入出力処理が必要な時)において発生する。
<h2>内部割込み</h2>
実行しているタスク内部に起因して起きる割込み<br>
プログラム割込み：実行プログラム内でのゼロによる除算、桁あふれなど。問題では具体例で聞かれる。<br>
SVC割込み:入出力処理の要求など、カーネル呼び出し命令の発行時に発生する割込み。<br>
<h2>外部割込み</h2>
内部割込みに該当しないもの。<br>
入出力割込み:入出力装置の動作完了時や中断時に生じる割り込み<br>
機械チェック割込み:電源の異常や主記憶装置の障害などのハードウェアの異常による割込み<br>
コンソール割込み:ユーザーが介入したことによる割込み(処理中にesc押すとか)<br>
タイマ割込み:既定の時間を過ぎたときに生じる割込み。
